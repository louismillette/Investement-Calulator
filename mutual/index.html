<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Mutual Fund - Compound Investement Calculator</title>
        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../css/highlight.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        <script src="../js/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/highlight.pack.js"></script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../calculator/">Compound Investement Calculator</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li >
                        <a href="../calculator/">Calculator</a>
                    </li>
                    <li >
                        <a href="..">Index Fund Application</a>
                    </li>
                    <li class="active">
                        <a href="./">Mutual Fund</a>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="..">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li class="disabled">
                        <a rel="prev" >
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#reverse-engineering-mutual-funds">Reverse Engineering Mutual Funds</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="reverse-engineering-mutual-funds">Reverse Engineering Mutual Funds</h1>
<p>Mutual Funds provided by banks and financial institutions like this one https://www.cibc.com/en/personal-banking/investments/mutual-funds/growth-funds/balanced-fund.html can be a bit misleading.  Instead of providing how much the fund grew in each year, they'll provide average compound returns for a handful of years.  In order to compare them to index funds that provide clearer information, one must parse out the information</p>
<p>When you see something like "the 5 year compounded average is 5.7%" what is really being said is 
<script type="math/tex; mode=display"> \frac{\prod_{i=1}^{5}(1 + r_{i}) - 1}{5} = 0.057 </script>
</p>
<p>where <script type="math/tex"> r_{i} </script> is the return in period i.  When multiple such expressions are given, multiple formulas must be satisfied simultaniously, giving us a good base to estimate what the missing returns might be.  For, say, a 30 year mutual fund with compounding averages given for 1,5,10, and 30 years, these formulas look like this:
<script type="math/tex; mode=display"> r_{30} = \phi_{1} </script>
<script type="math/tex; mode=display"> r_{25} \cdot r_{26} \cdot r_{27} \cdot r_{28} \cdot r_{29} \cdot r_{30} = 5 \cdot \phi_{5} + 1  </script>
<script type="math/tex; mode=display"> r_{20} \cdot r_{21} \cdot ... \cdot r_{30} = 10 \cdot \phi_{10} + 1  </script>
<script type="math/tex; mode=display"> r_{1} \cdot r_{2} \cdot ... \cdot r_{30} = 30 \cdot \phi_{30} + 1  </script>
</p>
<p>Here, the phi's are the average compound rates given by the fund.  In this scenario, each equation can be solved in the simplest way possible by assuming all previously indefined rates are the same.  For the purpose of our mutual funds, this is as good a guess as any that satisfy the equations.  For the rest of this doc, i'll refer to <script type="math/tex"> r_{i} </script> instead of <script type="math/tex"> 1 + r_{i} </script> to make it clearer.  For each equation of the n most recent returns, d the set of aleardy defined rates, and u the set of undefined rates:</p>
<p>
<script type="math/tex; mode=display"> \frac{n \cdot \phi_{n} + 1}{\prod_{\forall d}r_{i}} = \prod_{\forall u} r_{j} \space\space where \space\space r_{i} = r_{j} \space \forall i,j \space in \space u </script>
<script type="math/tex; mode=display">let \space\space \gamma = \frac{n \cdot \phi_{n} + 1}{\prod_{\forall d}r_{i}}</script>
<script type="math/tex; mode=display"> r_{j} =  \sqrt[u]{\gamma} </script>
</p>
<p>Where that last root is the uth root of gamma (really the size of u).  So for each equation we have to work with, we can reverse engineer rates between each period of years given by the financial institution.  In python:</p>
<pre><code>'''
buildFund takes average yearly compounded rates, and fills in missing years, returning a &quot;best guess&quot; as
to what the returns look like.
Fundreturns: &lt;dict&gt; {1987:.059, 2017:.07, ...} keys are the year-to-present average compound returns
         if the last year returns were 7%, it would be key:value of 2017:.07
returns: list of dict: [{&quot;Date&quot;:1970-07-20, &quot;Relevent Returns&quot;:.05},...]
'''
def buildFund(Fundreturns):
    dates = list(reversed(sorted(Fundreturns.keys())))
    leng = int(dates[0]) - int(dates[-1]) + 1
    keys = [str(ele) for ele in range(int(dates[-1]), int(dates[0]) + 1)]
    returns = dict(zip(keys,[1 for _ in range(leng)]))
    returns[dates[0]] = Fundreturns[dates[0]]
    i = 0
    while i &lt; len(dates):
        i += 1
        try:
            dates[i]
        except:
            break
        compounding = list(range(int(dates[i]), int(dates[0]) + 1))
        ret =  {k: v for k, v in returns.items() if int(k) in compounding} # dict of our compounding dates
        phi =  {k: v for k, v in ret.items() if v != 1} # dict of dates already processed by earlier compounding averages
        unass_dates = [k for k, v in ret.items() if v == 1]
        num = len(compounding) * (Fundreturns[dates[i]] - 1) + 1
        denom = reduce(operator.mul, phi.values())
        m = num/denom
        rate = round(m**(1/(len(unass_dates))),7)
        for date in unass_dates:
            returns[date] = rate
    retFormat = []
    for k,v in returns.items():
        retFormat.append({&quot;Date&quot;:k + '-12-01', &quot;Return Percent&quot;:v-1, &quot;Dividend Yield&quot;: 0})
    return retFormat
</code></pre></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>var base_url = '..';</script>
        <script src="../js/base.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script src="../search/require.js"></script>
        <script src="../search/search.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td><kbd>&larr;</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td><kbd>&rarr;</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>


    </body>
</html>
